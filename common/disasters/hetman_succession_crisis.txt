# =========================================================================
# HETMAN SUCCESSION CRISIS DISASTER
# (XVII–XVIII ст.: 1657–1740 р.р. — хронічна нестабільність)
# =========================================================================
#
# HISTORICAL BACKGROUND:
# The Hetmanate's chronic vulnerability to succession crises flowed from a fundamental
# paradox: the hetman office was elective (not hereditary), yet increasingly pressured
# by overlords (Poland, Russia, Crimea, Ottoman) who sought to impose favored candidates.
# Each hetman's death became a flashpoint for foreign intervention and starshyna factionalism.
#
# Key Succession Crises:
# - 1657 Succession (After Khmelnytsky): Yuri Khmelnytsky (weak, young) elected; factions 
#   immediately fragment into Right/Left Bank supporters; Vyhovsky attempts Hadyach Union;
#   Polish magnates and Russian envoys compete for influence.
# - 1664 Succession: Vyhovsky's fall; Samoylovych rises on Left Bank backed by Moscow;
#   Doroshenko dominates Right Bank backed by Ottomans; parallel governments, mutual raids.
# - 1688 Succession: Ivan Samoylenko elected but Moscow prefers Ivan Mazepa → factional strife;
#   Mazepa triumphs, consolidates power through patronage and modernization.
# - 1709–1764 Succession: After Mazepa's death, Moscow tightens control by appointing hetmans
#   directly; the elective system becomes nominal; Russian governors increasingly dominate.
#
# Key Figures (Succession Contenders):
# - Bohdan Khmelnytsky (d. 1657): Founder; his death triggers the first great crisis
# - Yuri Khmelnytsky (1641-1682): Son, weak; puppet of starshyna and foreign powers
# - Ivan Vyhovsky (1609-1664): Right-Bank rival; attempts Hadyach Union with Poland
# - Petro Doroshenko (1627-1698): Right-Bank warlord; pragmatically shifts between Poles, 
#   Ottomans, Russians as necessity dictates
# - Ivan Samoylovych (1633-1690): Left-Bank hetman; pro-Moscow, defeats rivals through 
#   diplomacy and Moscow's military backing
# - Ivan Samoylenko (d. 1710): Briefly elected 1687; overshadowed by Mazepa
# - Ivan Mazepa (1639-1709): The centralizer; consolidates office, modernizes army and culture,
#   yet remains Moscow's client until 1708 when he attempts escape to Swedes (fails at Poltava)
#
# Structural Mechanisms of Crisis:
# - Electoral System & Foreign Pressure: Hetman office filled by Rada (council) elections,
#   but Poland claims veto right (via vassal rhetoric); Moscow demands favorable candidates
#   after 1654 Pereiaslav; Ottoman/Crimea threaten or back candidates on Right Bank.
# - Starshyna Factionalism: General, Chancellor, Judge, Koshivyy Otaman positions wield
#   tremendous power and compete for supremacy; each faction backs rival candidates.
# - Economic Patronage: Hetman must distribute lands, military posts, and trading monopolies
#   to maintain starshyna loyalty; succession contests become bids to control patronage networks.
# - Military Cossackry: Sich (Zaporozhian) and regimental cossacks can defect to rival
#   candidates or demand concessions (pay, freedoms); a weak hetman-elect risks mutiny.
# - Religious Leverage: Catholic vs. Orthodox tensions, uniate pressure, foreign religious
#   diplomacy; succession candidates sometimes backed by religious factions.
#
# Crisis Mechanics in Historical Record:
# - Pretender Rebellions: Defeated rivals and their followers refuse to acknowledge new hetman;
#   civil war ensues (e.g., Vyhovsky vs. Samoylovych, 1660s).
# - Foreign Intervention: Poland mobilizes magnates; Russia sends troops and appointees;
#   Crimea/Ottoman raid or blockade; Swedish/Lithuanian neighbors circle expectantly.
# - Legitimacy Drain: A hetman imposed by foreign power loses Cossack credibility and must
#   spend political capital to consolidate rule; reform becomes impossible during crisis.
# - Starshyna Defection: Officer class switches sides based on patronage; armies melt away;
#   border fortifications fall to competitors or foreign raiders.
# - Economic Disruption: War tax, military mobilization, and blockades drain treasury;
#   peasants flee to Sich or foreign lands; trade routes close.
#
# Game Design Notes:
# This disaster models the chronic "kingmaker" dynamic: the Hetmanate is too weak to impose
# succession autonomously yet too large for foreign masters to fully control. The disaster
# triggers when: (a) hetman is weak/old/young and legitimacy <50%, (b) starshyna power 
# >70% and crown land <30%, (c) foreign overlord has poor opinion. It progresses when the 
# hetman tries to consolidate (reform speed), but moderates as hetman builds legitimacy 
# and starshyna loyalty. Ending requires high legitimacy, no regency, and foreign opinion fixed.
#
# Historical Mechanics:
# - Hetman Electoral System: Office elective, not hereditary → rival candidates backed by 
#   Poland, Russia, Crimea, Ottoman competing for overlord favor
# - Starshyna Power Struggles: Officer class (generals, koshivyy otaman, clerk, judge) wield
# - Foreign Vassalization Pressure: Each overlord attempts to impose a client-hetman; the
#   resulting hetman-elect is weakened politically and must spend reform capital on consolidation
# - Religious & Ideological Divisions: Catholic vs. Orthodox, Uniate pressures, theological
#   disputations used as diplomatic weapons by rival powers and starshyna factions
#
# Narrative: Simulates succession crises like those following Bohdan Khmelnytsky (1657),
# the rivalry between Doroshenko and Samoylovych (1660s-70s), and Mazepa's defection (1708).
# Each crisis could lead to partition, foreign vassalization, or renewed hetman authority.
#
# References:
# - Orest Subtelny, *The Mazepists* (1981)
# - Paul Robert Magocsi, *A History of Ukraine* (1996)
# - Jaroslaw Pelenski, *The Contest for the Legacy of Kievan Rus'* (1998)
# - Zenon Kohut, *Russian Centralism and Ukrainian Autonomy* (1988)
# - Frank Sysyn, *Between Poland and the Ukraine* (1985)
# - Mykhailo Hrushevsky, *History of Ukraine-Rus'*, vol. 9
# =========================================================================

hetman_succession_crisis = {

	potential = {
		tag = HET
		normal_or_historical_nations = yes
		government = monarchy
	}

	can_start = {
		has_any_disaster = no
		OR = {
			current_age = age_of_reformation
			current_age = age_of_absolutism
			current_age = age_of_revolutions
		}
		OR = {
			# Hetman death/weak ruler
			AND = {
				NOT = { legitimacy = 50 }
				OR = {
					has_regency = yes
					ruler_age = 60
				}
			}
			# Starshyna power struggle
			AND = {
				estate_influence = {
					estate = estate_nobles
					influence = 60
				}
				NOT = { crown_land_share = 30 }
			}
			# Foreign pressure for regime change
			AND = {
				is_subject = yes
				overlord = {
					OR = {
						tag = POL
						tag = MOS
						tag = RUS
					}
					NOT = {
						has_opinion = {
							who = ROOT
							value = 0
						}
					}
				}
			}
			# Rival hetman faction
			AND = {
				stability = -1
				num_of_powerful_estates = 2
			}
		}
	}
	on_start = het_succession.1

	can_stop = {
		has_any_disaster = yes
	}

	modifier = {
		global_unrest = 3
		legitimacy = -1.5
		stability_cost_modifier = 0.4
		reform_progress_growth = -0.3
		diplomatic_reputation = -2
		fort_maintenance_modifier = 0.2
		liberty_desire = 15
	}

	progress = {
		modifier = {
			factor = 2
			always = yes
		}
		modifier = {
			factor = 2.5
			NOT = { legitimacy = 30 }
		}
		modifier = {
			factor = 1.5
			has_regency = yes
		}
		modifier = {
			factor = 1.5
			estate_influence = {
				estate = estate_nobles
				influence = 70
			}
		}
		modifier = {
			factor = 1.3
			is_subject = yes
			overlord = {
				NOT = {
					has_opinion = {
						who = ROOT
						value = -50
					}
				}
			}
		}
		modifier = {
			factor = 1.5
			num_of_rebel_armies = 1
		}
		modifier = {
			factor = 0.75
			stability = 1
		}
		modifier = {
			factor = 0.5
			stability = 2
		}
		modifier = {
			factor = 0.7
			legitimacy = 70
		}
		modifier = {
			factor = 0.8
			crown_land_share = 40
		}
		modifier = {
			factor = 0.82
			has_country_modifier = registered_cossacks_south
		}
		modifier = {
			factor = 0.85
			has_country_modifier = su_frontier_statutes
		}
		modifier = {
			factor = 0.9
			has_country_flag = su_path_frontier_liberties
		}
		modifier = {
			factor = 1.2
			has_country_flag = su_path_maritime_raiding
			NOT = { legitimacy = 50 }
		}
	}

	can_end = {
		stability = 0
		legitimacy = 60
		NOT = { has_regency = yes }
		NOT = { num_of_rebel_armies = 1 }
		OR = {
			is_subject = no
			overlord = {
				has_opinion = {
					who = ROOT
					value = 0
				}
			}
		}
	}
	on_end = het_succession.2

	on_monthly = {
		random_events = {
			120 = het_succession.3
			100 = het_succession.4
			80 = het_succession.5
			60 = het_succession.6
		}
	}
}
