# =========================================================================
# ENHANCED HETMANATE MECHANICS
# =========================================================================
# Based on community suggestions from Paradox Forums
# "Update to Ukrainian region, Cossacks, content" by fr-rein
#
# KEY ENHANCEMENTS:
# 1. Hetman election mechanics (competitive vs hereditary)
# 2. Starshyna (officer class) political influence
# 3. Left Bank vs Right Bank division mechanics
# 4. Russian interference and autonomy struggle
# 5. Mazepa crisis and Swedish alliance option
# 6. Abolition crisis (Catherine II period)
#
# HISTORICAL CONTEXT:
# The Hetmanate (1648-1764) evolved from democratic Cossack uprising
# to autocratic state under Russian pressure. Key periods:
# - 1648-1654: Independent Hetmanate (Khmelnytsky)
# - 1654-1709: Russian protectorate, growing autocracy
# - 1709-1764: Post-Mazepa crisis, Russian control intensifies
# - 1764: Abolition by Catherine II
#
# REFERENCES:
# - Zenon Kohut, "Russian Centralism and Ukrainian Autonomy" (1988)
# - Orest Subtelny, "The Mazepists" (1983)
# - Serhii Plokhy, "The Cossacks and Religion" (2001)
# =========================================================================

namespace = het_enhanced

# Hetman Election Crisis - Competitive vs Hereditary
country_event = {
	id = het_enhanced.1
	title = "het_enhanced.1.t"
	desc = "het_enhanced.1.d"
	picture = ELECTION_REPUBLICAN_eventPicture
	
	trigger = {
		tag = HET
		has_reform = het_starshyna_oligarchy_reform
		NOT = { has_country_flag = hetman_election_crisis }
		is_year = 1660
		NOT = { is_year = 1760 }
	}
	
	mean_time_to_happen = {
		months = 120
	}
	
	# Support competitive elections (democratic)
	option = {
		name = "het_enhanced.1.a"
		add_republican_tradition = 10
		add_country_modifier = {
			name = "competitive_hetman_elections"
			duration = 7300
		}
		add_stability = -1
		set_country_flag = hetman_election_crisis
	}
	
	# Allow hereditary succession (autocratic)
	option = {
		name = "het_enhanced.1.b"
		add_republican_tradition = -10
		add_legitimacy = 15
		add_country_modifier = {
			name = "hereditary_hetman_succession"
			duration = 7300
		}
		set_country_flag = hetman_election_crisis
	}
	
	# Compromise: Limited hereditary rights
	option = {
		name = "het_enhanced.1.c"
		add_republican_tradition = -5
		add_legitimacy = 10
		add_stability_or_adm_power = yes
		set_country_flag = hetman_election_crisis
	}
}

# Starshyna Oligarchy Demands
country_event = {
	id = het_enhanced.2
	title = "het_enhanced.2.t"
	desc = "het_enhanced.2.d"
	picture = COURT_eventPicture
	
	trigger = {
		tag = HET
		estate_influence = {
			estate = estate_nobles
			influence = 50
		}
		NOT = { has_country_flag = starshyna_demands_recent }
	}
	
	mean_time_to_happen = {
		months = 60
	}
	
	# Grant Starshyna privileges
	option = {
		name = "het_enhanced.2.a"
		add_estate_influence_modifier = {
			estate = estate_nobles
			influence = 10
			duration = 7300
		}
		add_country_modifier = {
			name = "starshyna_privileges_granted"
			duration = 7300
		}
		set_country_flag = starshyna_demands_recent
	}
	
	# Resist Starshyna oligarchy
	option = {
		name = "het_enhanced.2.b"
		add_estate_loyalty_modifier = {
			estate = estate_nobles
			desc = het_resists_oligarchy_desc
			loyalty = -15
			duration = 3650
		}
		add_legitimacy = 10
		add_country_modifier = {
			name = "hetman_resists_oligarchy"
			duration = 3650
		}
		set_country_flag = starshyna_demands_recent
	}
}

# Left Bank vs Right Bank Division
country_event = {
	id = het_enhanced.3
	title = "het_enhanced.3.t"
	desc = "het_enhanced.3.d"
	picture = BORDER_TENSION_eventPicture
	
	trigger = {
		tag = HET
		is_year = 1667
		NOT = { is_year = 1680 }
		NOT = { has_country_flag = bank_division_crisis }
		any_owned_province = {
			area = east_dniepr_area
		}
		any_owned_province = {
			area = west_dniepr_area
		}
	}
	
	mean_time_to_happen = {
		months = 24
	}
	
	# Prioritize Left Bank (Russian sphere)
	option = {
		name = "het_enhanced.3.a"
		east_dniepr_area = {
			add_province_modifier = {
				name = "left_bank_priority"
				duration = -1
			}
		}
		if = {
			limit = { overlord = { tag = RUS } }
			overlord = {
				add_opinion = {
					who = ROOT
					modifier = het_left_bank_loyalty
				}
			}
		}
		set_country_flag = bank_division_crisis
	}
	
	# Maintain both banks equally
	option = {
		name = "het_enhanced.3.b"
		add_adm_power = -50
		add_country_modifier = {
			name = "unified_hetmanate_policy"
			duration = 7300
		}
		set_country_flag = bank_division_crisis
	}
	
	# Focus on Right Bank (Polish ties)
	option = {
		name = "het_enhanced.3.c"
		west_dniepr_area = {
			add_province_modifier = {
				name = "right_bank_priority"
				duration = -1
			}
		}
		if = {
			limit = { overlord = { tag = PLC } }
			overlord = {
				add_opinion = {
					who = ROOT
					modifier = het_right_bank_loyalty
				}
			}
		}
		set_country_flag = bank_division_crisis
	}
}

# Russian Interference in Hetman Elections
country_event = {
	id = het_enhanced.4
	title = "het_enhanced.4.t"
	desc = "het_enhanced.4.d"
	picture = BORDER_TENSION_eventPicture
	
	trigger = {
		tag = HET
		overlord = { tag = RUS }
		is_year = 1680
		NOT = { is_year = 1760 }
		NOT = { has_country_flag = russian_interference_recent }
	}
	
	mean_time_to_happen = {
		months = 80
	}
	
	# Accept Russian candidate
	option = {
		name = "het_enhanced.4.a"
		add_liberty_desire = -10
		overlord = {
			add_opinion = {
				who = ROOT
				modifier = accepted_russian_candidate
			}
		}
		add_legitimacy = -5
		add_republican_tradition = -5
		set_country_flag = russian_interference_recent
	}
	
	# Elect own candidate (autonomy)
	option = {
		name = "het_enhanced.4.b"
		add_liberty_desire = 15
		overlord = {
			add_opinion = {
				who = ROOT
				modifier = rejected_russian_candidate
			}
		}
		add_legitimacy = 10
		add_republican_tradition = 5
		set_country_flag = russian_interference_recent
	}
}

# Mazepa Crisis - Swedish Alliance Option
country_event = {
	id = het_enhanced.5
	title = "het_enhanced.5.t"
	desc = "het_enhanced.5.d"
	picture = DIPLOMACY_eventPicture
	
	trigger = {
		tag = HET
		has_reform = het_mazepist_autocracy_reform
		is_year = 1700
		NOT = { is_year = 1715 }
		overlord = { tag = RUS }
		exists = SWE
		SWE = { war_with = RUS }
		NOT = { has_country_flag = mazepa_crisis_resolved }
	}
	
	mean_time_to_happen = {
		months = 36
	}
	
	# Betray Russia, ally with Sweden (historical Mazepa choice)
	option = {
		name = "het_enhanced.5.a"
		trigger = {
			legitimacy_equivalent = 80
		}
		overlord = {
			add_opinion = {
				who = ROOT
				modifier = het_mazepa_treason
			}
		}
		SWE = {
			add_opinion = {
				who = ROOT
				modifier = hetmanate_swedish_alliance
			}
			create_alliance = ROOT
		}
		add_prestige = 20
		add_country_modifier = {
			name = "mazepist_gambit"
			duration = 3650
		}
		set_country_flag = mazepa_allied_sweden
		set_country_flag = mazepa_crisis_resolved
	}
	
	# Remain loyal to Russia
	option = {
		name = "het_enhanced.5.b"
		overlord = {
			add_opinion = {
				who = ROOT
				modifier = hetmanate_remained_loyal
			}
		}
		add_liberty_desire = -15
		add_legitimacy = 10
		set_country_flag = mazepa_crisis_resolved
	}
}

# Little Russian Collegium - Russian Direct Control
country_event = {
	id = het_enhanced.6
	title = "het_enhanced.6.t"
	desc = "het_enhanced.6.d"
	picture = COURT_eventPicture
	
	trigger = {
		tag = HET
		overlord = { tag = RUS }
		is_year = 1722
		NOT = { is_year = 1765 }
		NOT = { has_country_flag = collegium_established }
	}
	
	mean_time_to_happen = {
		months = 48
	}
	
	# Accept the Collegium (lose autonomy)
	option = {
		name = "het_enhanced.6.a"
		add_liberty_desire = -20
		add_country_modifier = {
			name = "little_russian_collegium"
			duration = -1
		}
		overlord = {
			add_opinion = {
				who = ROOT
				modifier = accepted_collegium
			}
		}
		set_country_flag = collegium_established
	}
	
	# Resist Russian control
	option = {
		name = "het_enhanced.6.b"
		add_liberty_desire = 20
		overlord = {
			add_opinion = {
				who = ROOT
				modifier = resisted_collegium
			}
		}
		add_country_modifier = {
			name = "resisting_russian_control"
			duration = 3650
		}
		set_country_flag = collegium_established
	}
}

# Hetmanate Abolition Crisis (1764)
country_event = {
	id = het_enhanced.7
	title = "het_enhanced.7.t"
	desc = "het_enhanced.7.d"
	picture = REFORM_eventPicture
	
	trigger = {
		tag = HET
		overlord = { tag = RUS }
		is_year = 1764
		NOT = { is_year = 1770 }
		NOT = { has_country_flag = abolition_threatened }
	}
	
	mean_time_to_happen = {
		months = 12
	}
	
	# Accept abolition peacefully
	option = {
		name = "het_enhanced.7.a"
		overlord = {
			inherit = ROOT
		}
	}
	
	# Fight for autonomy
	option = {
		name = "het_enhanced.7.b"
		trigger = {
			liberty_desire = 40
		}
		add_liberty_desire = 30
		declare_war_with_cb = {
			who = RUS
			casus_belli = cb_independence_war
		}
		add_country_modifier = {
			name = "fighting_for_hetmanate"
			duration = -1
		}
	}
	
	# Negotiate limited autonomy
	option = {
		name = "het_enhanced.7.c"
		add_country_modifier = {
			name = "limited_hetmanate_autonomy"
			duration = -1
		}
		overlord = {
			add_opinion = {
				who = ROOT
				modifier = negotiated_autonomy
			}
		}
		set_country_flag = abolition_threatened
	}
}

# Cossack Revival Movement (if survived abolition)
country_event = {
	id = het_enhanced.8
	title = "het_enhanced.8.t"
	desc = "het_enhanced.8.d"
	picture = REVOLUTION_eventPicture
	
	trigger = {
		tag = HET
		is_year = 1775
		NOT = { is_year = 1800 }
		is_subject = no
		NOT = { has_country_flag = cossack_revival_movement }
	}
	
	mean_time_to_happen = {
		months = 60
	}
	
	# Embrace Cossack traditions
	option = {
		name = "het_enhanced.8.a"
		add_country_modifier = {
			name = "cossack_traditions_revival"
			duration = -1
		}
		add_army_tradition = 20
		add_republican_tradition = 10
		set_country_flag = cossack_revival_movement
	}
	
	# Modernize as European state
	option = {
		name = "het_enhanced.8.b"
		add_country_modifier = {
			name = "hetmanate_modernization"
			duration = -1
		}
		add_adm_power = 50
		add_dip_power = 50
		set_country_flag = cossack_revival_movement
	}
}
